# Shopier Real-Money Readiness Plan

Before you can realize "real $" in your Shopier account, you must fulfill several legal and technical obligations. This plan outlines the necessary steps to transition from experimental mock data to a production-ready payment flow.

## User Review Required

> [!IMPORTANT]
> **Legal Compliance (Turkey-specific):** Since you are selling digital products/services through Shopier (a Turkish company), you are legally obligated to issue invoices for every sale. While Shopier allows individual sellers, regular commercial activity typically requires establishing a "Şahıs Şirketi" (Sole Proprietorship) to remain compliant with Turkish Tax Law.

> [!WARNING]
> **Digital Goods Refund Policy:** Per Shopier and Turkish Consumer Law, digital goods are generally non-refundable once delivered. However, you must explicitly state this in your "Distance Sales Contract" to avoid disputes.

## Proposed Changes

No immediate code changes are required for the "obligations" themselves, but your environment configuration must be updated.

### [Module] Environment Configuration

Update your [.env](file:///Users/pq/_youtube_ai_app_v3.0/.env) file with production credentials once the Shopier Dashboard steps are complete.

#### [MODIFY] [.env](file:///Users/pq/_youtube_ai_app_v3.0/.env)

- Replace `SHOPIER_API_KEY` with your production key.
- Replace `SHOPIER_API_SECRET` with your production secret.
- **Add** `SHOPIER_WEBHOOK_TOKEN` from the "Settings > Automation" section of Shopier.

### [Module] Shopier Service

#### [MODIFY] [shopier_service.py](file:///Users/pq/_youtube_ai_app_v3.0/modules/ai_agency/shopier_service.py)

- Ensure the [verify_callback](file:///Users/pq/_youtube_ai_app_v3.0/modules/ai_agency/shopier_service.py#117-145) logic uses the `SHOPIER_WEBHOOK_TOKEN` for production verification.

### [Module] Production Deployment Fixes

Correct the structural deployment issues causing 503 errors.

#### [MODIFY] [Dockerfile](file:///Users/pq/_youtube_ai_app_v3.0/backend/Dockerfile)

- Switch base image from `python:alpine` to `python:3.11-slim`.
- Move the Dockerfile execution context to the **Root** of the project to include `modules/` and `static/`.
- Adjust `uvicorn` startup command to `backend.main:app`.

#### [MODIFY] [cloudbuild.yaml](file:///Users/pq/_youtube_ai_app_v3.0/cloudbuild.yaml)

- Use the root-level cloudbuild to ensure all project folders are bundled into the container.

## Online Automation Strategy (Optimum Cron)

To ensure the YouTube AI Platform operates autonomously in production, we recommend using **Google Cloud Scheduler** to trigger the following "Ignite" operations.

### 1. Quantum Market Scaling (High Frequency)
- **Schedule:** `0 */4 * * *` (Every 4 Hours)
- **Action:** POST to `/api/agency/orchestrate/quantum`
- **Body:** `{"intent": "Execute horizontal scaling across high-CPM niches and maximize revenue velocity."}`
- **Goal:** Continuously scans and "entangles" new opportunities for income.

### 2. Storefront Refresh & Audit (Daily)
- **Schedule:** `0 4 * * *` (Daily at 04:00 UTC)
- **Action:** POST to `/api/agency/orchestrate/sales`
- **Body:** `{"operation": "deploy_storefront"}`
- **Goal:** Re-ranks digital products and refreshes the public-facing storefront.

### 3. Content Engine Pulse (Service)
- **Schedule:** `0 8,20 * * *` (Twice Daily - 08:00 and 20:00)
- **Action:** POST to `/api/agency/orchestrate/service`
- **Body:** `{"workflow_id": "youtube_automation"}`
- **Goal:** Triggers the AI content generation pipeline to keep the channel active.

> [!TIP]
> **Authentication:** When setting up Google Cloud Scheduler, ensure you use an **OIDC Token** (using a Service Account with 'Cloud Run Invoker' permissions) so the backend accepts the request.

## Verification Plan

1. **Dashboard Check:** Verify that Shopier status shows "Active" and "Verified".
2. **$1 Transaction Test:** Create a test product listed at 1 TL. Purchase it using a real credit card.
3. **Ledger Check:** Verfiy that the transaction appears in your backend ledger and the [FulfillmentEngine](file:///Users/pq/_youtube_ai_app_v3.0/modules/ai_agency/fulfillment_engine.py#9-179) triggers the digital asset delivery.
